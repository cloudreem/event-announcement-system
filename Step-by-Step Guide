# AWS Event Announcement System - Serverless Project

A fully serverless event announcement platform built with AWS services:

- Static website hosted on **S3**
- Backend API powered by **API Gateway** + **Lambda**
- Email notifications via **SNS**
- Event data stored in a simple `events.json` file in S3

Users can:
- Subscribe to receive email notifications about new events
- Admins (or anyone) can create new events
- New events are automatically announced via email to all subscribers
- Current events are displayed on the frontend

Perfect for small communities, clubs, or internal announcements.

## Architecture Overview

```
Frontend (S3 Static Website)
        â†“ (HTTPS)
API Gateway (REST API)
        â†“ (POST /subscribe â†’ Lambda)
SubscribeToEventsLambda â†’ SNS (email subscription)
        â†“ (POST /create-event â†’ Lambda)
CreateEventLambda â†’ Updates events.json in S3 + Publishes to SNS Topic
        â†“
SNS Topic â†’ Sends email to all confirmed subscribers
```

## Prerequisites

- An AWS account
- Basic familiarity with the AWS Management Console
- A code editor for creating the frontend files

## Step-by-Step Setup Guide

### Step 1: Create the S3 Bucket for Static Website Hosting

1. Go to the **S3** service in the AWS Console.
2. Click **Create bucket**.
3. Enter a globally unique bucket name (e.g., `my-event-announcement-system-2025`).
4. Choose your preferred region (recommended: `us-east-1` for lower costs).
5. **Uncheck** "Block all public access" (we need public read access for the website).
6. Leave other settings as default â†’ **Create bucket**.
7. Upload initial files (you'll create these in Step 6):
   - `events.json` (content: `[]`)
   - `index.html`
   - `style.css`
   - `script.js`
8. Enable static website hosting:
   - Select your bucket â†’ **Properties** tab â†’ **Static website hosting** â†’ **Edit**
   - Choose **Enable**
   - Index document: `index.html`
   - Error document (optional): `error.html`
   - **Save changes**
   - Note the **Website endpoint** URL (e.g., `http://my-event-announcement-system.s3-website-us-east-1.amazonaws.com`) â€” you'll use this later.
9. Make the bucket publicly readable:
   - Go to **Permissions** tab â†’ **Bucket policy** â†’ **Edit**
   - Paste the following policy (replace `my-event-announcement-system` with your bucket name):

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "PublicReadGetObject",
      "Effect": "Allow",
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::my-event-announcement-system/*"
    }
  ]
}
```

   - **Save changes**

### Step 2: Create an SNS Topic

1. Go to **Amazon SNS** â†’ **Topics** â†’ **Create topic**
2. Type: **Standard**
3. Name: `EventAnnouncementsTopic`
4. Click **Create topic**
5. Copy the **Topic ARN** â€” you'll need it in the Lambda functions.

### Step 3: Create the Lambda Functions

#### Common Settings
- Runtime: **Python 3.12**
- Architecture: **x86_64**
- Timeout: Increase to **10 seconds**

#### 3a: SubscribeToEventsLambda (/subscribe endpoint)

1. Go to **Lambda** â†’ **Create function**
2. Name: `SubscribeToEventsLambda`
3. Runtime: Python 3.12
4. Create function
5. In the **Code** tab, replace the default code with:

```python
import json
import boto3

sns = boto3.client('sns')
TOPIC_ARN = 'arn:aws:sns:YOUR-REGION:YOUR-ACCOUNT-ID:EventAnnouncementsTopic'  # Replace with your actual Topic ARN

def lambda_handler(event, context):
    try:
        body = json.loads(event['body'])
        email = body['email']
        
        response = sns.subscribe(
            TopicArn=TOPIC_ARN,
            Protocol='email',
            Endpoint=email,
            ReturnSubscriptionArn=True
        )
        
        return {
            'statusCode': 200,
            'headers': {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': '*'
            },
            'body': json.dumps({
                'message': 'Subscription request sent. Check your email to confirm.',
                'subscriptionArn': response['SubscriptionArn']
            })
        }
    except Exception as e:
        return {
            'statusCode': 500,
            'headers': {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': '*'
            },
            'body': json.dumps({'error': str(e)})
        }
```

6. **Deploy** the function.

#### 3b: CreateEventLambda (/create-event endpoint)

1. Create another function named `CreateEventLambda`
2. Replace code with:

```python
import json
import boto3

s3 = boto3.client('s3')
sns = boto3.client('sns')

BUCKET_NAME = 'my-event-announcement-system'  # Replace with your bucket name
FILE_KEY = 'events.json'
TOPIC_ARN = 'arn:aws:sns:YOUR-REGION:YOUR-ACCOUNT-ID:EventAnnouncementsTopic'  # Replace with your Topic ARN

def lambda_handler(event, context):
    try:
        body = json.loads(event['body'])
        new_event = {
            'title': body['title'],
            'description': body['description'],
            'date': body['date']
        }
        
        # Read current events
        response = s3.get_object(Bucket=BUCKET_NAME, Key=FILE_KEY)
        events = json.loads(response['Body'].read().decode('utf-8'))
        
        # Append new event
        events.append(new_event)
        
        # Write back to S3
        s3.put_object(
            Bucket=BUCKET_NAME,
            Key=FILE_KEY,
            Body=json.dumps(events, indent=2).encode('utf-8'),
            ContentType='application/json'
        )
        
        # Notify subscribers
        message = f"New Event Announced!\n\nTitle: {new_event['title']}\nDate: {new_event['date']}\nDescription: {new_event['description']}"
        sns.publish(
            TopicArn=TOPIC_ARN,
            Message=message,
            Subject='New Event Announcement'
        )
        
        return {
            'statusCode': 200,
            'headers': {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': '*'
            },
            'body': json.dumps({'message': 'Event created and notification sent!'})
        }
    except Exception as e:
        return {
            'statusCode': 500,
            'headers': {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': '*'
            },
            'body': json.dumps({'error': str(e)})
        }
```

3. **Deploy**

#### Add IAM Permissions to CreateEventLambda

1. Go to `CreateEventLambda` â†’ **Configuration** â†’ **Permissions**
2. Click the role name â†’ **Add permissions** â†’ **Create inline policy** â†’ JSON
3. Paste:

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": ["s3:GetObject", "s3:PutObject"],
            "Resource": "arn:aws:s3:::my-event-announcement-system/*"
        }
    ]
}
```

4. Name it (e.g., `S3AccessForEvents`) â†’ Create policy

> Note: Both Lambdas should have SNS publish/subscribe permissions by default (via AWSLambdaBasicExecutionRole). If not, add them similarly.

### Step 4: Create the API Gateway

1. Go to **API Gateway** â†’ **Create API** â†’ Choose **REST API** â†’ **Build**
2. API name: `EventAnnouncementAPI`
3. Endpoint type: **Regional**
4. Create API

#### Set Security Policy (Recommended for 2025+)

1. In the left menu, go to **Settings** â†’ **Edit**
2. Under **Security policy**, select **TLS 1.2** (or TLS 1.3 if you want stricter)
3. Save

#### Create Resources and Methods

**For /subscribe:**
1. Under **Resources**, click **Actions** â†’ **Create Resource**
2. Resource name: `subscribe`, Path: `/subscribe` â†’ Create
3. Select `/subscribe` â†’ **Actions** â†’ **Create Method** â†’ Choose **POST**
4. Integration type: **Lambda Function**
5. Check **Use Lambda Proxy integration**
6. Select your region and `SubscribeToEventsLambda`
7. Save â†’ Confirm permission to invoke Lambda

**For /create-event:**
1. Repeat: Create resource `create-event` â†’ Path `/create-event`
2. Create **POST** method â†’ Integrate with `CreateEventLambda` (proxy integration)

#### Enable CORS

1. Select `/subscribe` â†’ **Actions** â†’ **Enable CORS**
2. Accept defaults â†’ **Enable CORS and replace existing headers**
3. Repeat for `/create-event`

> For production, restrict `Access-Control-Allow-Origin` to your S3 domain instead of `*`

#### Deploy the API

1. **Actions** â†’ **Deploy API**
2. Stage: **[New Stage]**
3. Stage name: `prod`
4. Deploy
5. Copy the **Invoke URL** (e.g., `https://abc123.execute-api.us-east-1.amazonaws.com/prod`)

### Step 5: Frontend Files (Upload to S3)

Create these files locally and upload them to your S3 bucket.

#### `index.html`

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Announcement System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Event Announcements</h1>

        <section>
            <h2>Subscribe to Notifications</h2>
            <input type="email" id="email" placeholder="your@email.com" required>
            <button onclick="subscribe()">Subscribe</button>
            <p id="subMsg"></p>
        </section>

        <section>
            <h2>Announce New Event</h2>
            <input type="text" id="title" placeholder="Event Title" required><br>
            <textarea id="desc" placeholder="Description" rows="3"></textarea><br>
            <input type="date" id="date" required><br>
            <button onclick="createEvent()">Announce Event</button>
            <p id="eventMsg"></p>
        </section>

        <section>
            <h2>Current Events</h2>
            <ul id="eventsList"></ul>
        </section>
    </div>

    <script src="script.js"></script>
</body>
</html>
```

#### `style.css`

```css
body {
    font-family: Arial, sans-serif;
    margin: 40px;
    background: #f9f9f9;
    color: #333;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

h1, h2 {
    color: #2c3e50;
}

input, textarea, button {
    margin: 10px 0;
    padding: 10px;
    width: 100%;
    box-sizing: border-box;
    border: 1px solid #ccc;
    border-radius: 5px;
}

button {
    background: #3498db;
    color: white;
    cursor: pointer;
    font-size: 16px;
}

button:hover {
    background: #2980b9;
}

ul {
    list-style: none;
    padding: 0;
}

li {
    background: #ecf0f1;
    margin: 10px 0;
    padding: 15px;
    border-radius: 5px;
}

p {
    font-weight: bold;
    min-height: 24px;
}
```

#### `script.js`

```javascript
const API_BASE = 'https://YOUR-API-ID.execute-api.YOUR-REGION.amazonaws.com/prod';  // â† Replace with your API Gateway URL
const EVENTS_URL = 'http://YOUR-BUCKET.s3-website-YOUR-REGION.amazonaws.com/events.json';  // â† Replace with your S3 website URL

async function subscribe() {
    const email = document.getElementById('email').value;
    if (!email) return alert("Please enter an email");

    try {
        const response = await fetch(`${API_BASE}/subscribe`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({email})
        });
        const data = await response.json();
        document.getElementById('subMsg').textContent = data.message || data.error;
    } catch (err) {
        document.getElementById('subMsg').textContent = 'Error: ' + err.message;
    }
}

async function createEvent() {
    const event = {
        title: document.getElementById('title').value,
        description: document.getElementById('desc').value,
        date: document.getElementById('date').value
    };

    if (!event.title || !event.date) return alert("Title and date are required");

    try {
        const response = await fetch(`${API_BASE}/create-event`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(event)
        });
        const data = await response.json();
        document.getElementById('eventMsg').textContent = data.message || data.error;
        loadEvents();
    } catch (err) {
        document.getElementById('eventMsg').textContent = 'Error: ' + err.message;
    }
}

async function loadEvents() {
    try {
        const response = await fetch(EVENTS_URL);
        const events = await response.json();
        const list = document.getElementById('eventsList');
        list.innerHTML = '';
        events.forEach(e => {
            const li = document.createElement('li');
            li.innerHTML = `<strong>${e.title}</strong> - ${e.date}<br>${e.description}`;
            list.appendChild(li);
        });
    } catch (err) {
        console.error("Failed to load events:", err);
    }
}

// Load events when page opens
loadEvents();
```

#### `events.json`

```json
[]
```

Upload all four files to your S3 bucket root.

### Final Step: Test Your Application

1. Visit your S3 website endpoint URL.
2. Subscribe with a real email â†’ check inbox/spam for confirmation link.
3. Confirm subscription.
4. Create a test event â†’ you should receive an email notification.
5. Refresh the page â†’ new event appears in the list.

**Done!** You now have a working serverless event announcement system.

## Security Notes

- For production: Restrict CORS to your domain
- Consider adding authentication (e.g., API keys or Cognito) to `/create-event`
- Use CloudFront in front of S3 for HTTPS and better performance

Enjoy your serverless event system! ðŸš€
